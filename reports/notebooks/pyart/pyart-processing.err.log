Traceback (most recent call last):
  File "/srv/conda/envs/notebook/lib/python3.9/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/srv/conda/envs/notebook/lib/python3.9/site-packages/nbclient/client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/srv/conda/envs/notebook/lib/python3.9/site-packages/jupyter_core/utils/__init__.py", line 173, in wrapped
    return loop.run_until_complete(inner)
  File "/srv/conda/envs/notebook/lib/python3.9/asyncio/base_events.py", line 647, in run_until_complete
    return future.result()
  File "/srv/conda/envs/notebook/lib/python3.9/site-packages/nbclient/client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "/srv/conda/envs/notebook/lib/python3.9/site-packages/nbclient/client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/srv/conda/envs/notebook/lib/python3.9/site-packages/nbclient/client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
centroids = np.array([[13.8231,0.2514,0.0644,0.9861,1380.6],
[3.0239,0.1971,0.,0.9661,1464.1],
[4.9447,0.1142,0.,0.9787,-974.7],
[34.2450,0.5540,0.1459,0.9937,945.3],
[40.9432,1.0110,0.5141,0.9928,-993.5],
[3.5202,-0.3498,0.,0.9746,843.2],
[32.5287,0.9751,0.2640,0.9804,-55.5],
[52.6547,2.7054,2.5101,0.9765,-1114.6],
[46.4998,0.1978,0.6431,0.9845,1010.1]])


hydro = pyart.retrieve.hydroclass_semisupervised(radar, mass_centers = centroids,
                                 refl_field =  'corrected_reflectivity',
                                 zdr_field = 'corrected_differential_reflectivity',
                                 kdp_field = 'specific_differential_phase',
                                 rhv_field = 'uncorrected_cross_correlation_ratio',
                                 temp_field = 'temperature')

radar.add_field('radar_echo_classification', hydro)

fig, ax = plt.subplots(1,1, figsize=(6,6))
display = pyart.graph.RadarDisplay(radar)
import matplotlib as mpl

labels = ['NC','AG', 'CR', 'LR', 'RP', 'RN', 'VI', 'WS', 'MH', 'IH/HDG']
ticks = np.arange(len(labels))
boundaries = np.arange(-0.5, len(labels) )
norm = mpl.colors.BoundaryNorm(boundaries, 256)

cax = display.plot_ppi('radar_echo_classification', 0, ax = ax,  gatefilter = gtfilter,
                 norm = norm, ticks = ticks, ticklabs = labels)

ax.set_xlim([-50,50])
ax.set_ylim([-50,50])
ax.set_aspect('equal', 'box')
------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mKeyError[0m                                  Traceback (most recent call last)
Cell [0;32mIn[8], line 19[0m
[1;32m      1[0m centroids [38;5;241m=[39m np[38;5;241m.[39marray([[[38;5;241m13.8231[39m,[38;5;241m0.2514[39m,[38;5;241m0.0644[39m,[38;5;241m0.9861[39m,[38;5;241m1380.6[39m],
[1;32m      2[0m [[38;5;241m3.0239[39m,[38;5;241m0.1971[39m,[38;5;241m0.[39m,[38;5;241m0.9661[39m,[38;5;241m1464.1[39m],
[1;32m      3[0m [[38;5;241m4.9447[39m,[38;5;241m0.1142[39m,[38;5;241m0.[39m,[38;5;241m0.9787[39m,[38;5;241m-[39m[38;5;241m974.7[39m],
[0;32m   (...)[0m
[1;32m      8[0m [[38;5;241m52.6547[39m,[38;5;241m2.7054[39m,[38;5;241m2.5101[39m,[38;5;241m0.9765[39m,[38;5;241m-[39m[38;5;241m1114.6[39m],
[1;32m      9[0m [[38;5;241m46.4998[39m,[38;5;241m0.1978[39m,[38;5;241m0.6431[39m,[38;5;241m0.9845[39m,[38;5;241m1010.1[39m]])
[1;32m     12[0m hydro [38;5;241m=[39m pyart[38;5;241m.[39mretrieve[38;5;241m.[39mhydroclass_semisupervised(radar, mass_centers [38;5;241m=[39m centroids,
[1;32m     13[0m                                  refl_field [38;5;241m=[39m  [38;5;124m'[39m[38;5;124mcorrected_reflectivity[39m[38;5;124m'[39m,
[1;32m     14[0m                                  zdr_field [38;5;241m=[39m [38;5;124m'[39m[38;5;124mcorrected_differential_reflectivity[39m[38;5;124m'[39m,
[1;32m     15[0m                                  kdp_field [38;5;241m=[39m [38;5;124m'[39m[38;5;124mspecific_differential_phase[39m[38;5;124m'[39m,
[1;32m     16[0m                                  rhv_field [38;5;241m=[39m [38;5;124m'[39m[38;5;124muncorrected_cross_correlation_ratio[39m[38;5;124m'[39m,
[1;32m     17[0m                                  temp_field [38;5;241m=[39m [38;5;124m'[39m[38;5;124mtemperature[39m[38;5;124m'[39m)
[0;32m---> 19[0m [43mradar[49m[38;5;241;43m.[39;49m[43madd_field[49m[43m([49m[38;5;124;43m'[39;49m[38;5;124;43mradar_echo_classification[39;49m[38;5;124;43m'[39;49m[43m,[49m[43m [49m[43mhydro[49m[43m)[49m
[1;32m     21[0m fig, ax [38;5;241m=[39m plt[38;5;241m.[39msubplots([38;5;241m1[39m,[38;5;241m1[39m, figsize[38;5;241m=[39m([38;5;241m6[39m,[38;5;241m6[39m))
[1;32m     22[0m display [38;5;241m=[39m pyart[38;5;241m.[39mgraph[38;5;241m.[39mRadarDisplay(radar)

File [0;32m/srv/conda/envs/notebook/lib/python3.9/site-packages/pyart/core/radar.py:805[0m, in [0;36mRadar.add_field[0;34m(self, field_name, dic, replace_existing)[0m
[1;32m    803[0m     [38;5;28;01mraise[39;00m [38;5;167;01mValueError[39;00m(err)
[1;32m    804[0m [38;5;28;01mif[39;00m [38;5;124m'[39m[38;5;124mdata[39m[38;5;124m'[39m [38;5;129;01mnot[39;00m [38;5;129;01min[39;00m dic:
[0;32m--> 805[0m     [38;5;28;01mraise[39;00m [38;5;167;01mKeyError[39;00m([38;5;124m"[39m[38;5;124mdic must contain a [39m[38;5;124m'[39m[38;5;124mdata[39m[38;5;124m'[39m[38;5;124m key[39m[38;5;124m"[39m)
[1;32m    806[0m [38;5;28;01mif[39;00m dic[[38;5;124m'[39m[38;5;124mdata[39m[38;5;124m'[39m][38;5;241m.[39mshape [38;5;241m!=[39m ([38;5;28mself[39m[38;5;241m.[39mnrays, [38;5;28mself[39m[38;5;241m.[39mngates):
[1;32m    807[0m     t [38;5;241m=[39m (
[1;32m    808[0m         [38;5;28mself[39m[38;5;241m.[39mnrays, [38;5;28mself[39m[38;5;241m.[39mngates, dic[[38;5;124m'[39m[38;5;124mdata[39m[38;5;124m'[39m][38;5;241m.[39mshape[[38;5;241m0[39m],
[1;32m    809[0m         dic[[38;5;124m'[39m[38;5;124mdata[39m[38;5;124m'[39m][38;5;241m.[39mshape[[38;5;241m1[39m])

[0;31mKeyError[0m: "dic must contain a 'data' key"

